%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                                   Introduction                              %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Introduction}\label{sec:introduction}

A central problem in the study of the solar corona is whether EUV and soft X-ray observations of \AR s \replaced{imply}{are consistent with} the plasma being heated steadily or impulsively.
Observations of hot plasma by the X-Ray Telescope \citep[XRT,][]{golub_x-ray_2007} on the \textit{Hinode} spacecraft \citep{kosugi_hinode_2007} indicate that \AR{} cores are heated steadily \citep[e.g.][]{warren_constraints_2011,winebarger_using_2011}.
Alternatively, observations of cooler ($\sim1$ MK) plasma have been shown to be more consistent with impulsive heating where the plasma is allowed to cool significantly \added{ between consecutive heating events} \citep[e.g][]{winebarger_evolving_2003,mulu-moore_determining_2011,ugarte-urra_investigation_2006,viall_patterns_2011,viall_evidence_2012}.
More recent work \citep{del_zanna_evolution_2015,bradshaw_patterns_2016} suggests that observations of a single \AR{} may be consistent with both steady and impulsive heating, depending on the location within the \AR{}.
\added{Additionally, a given flux tube at a single location may undergo a range of heating frequencies \citep[e.g.][]{cargill_active_2014}.}
Collectively, these results suggest that \AR s may be heated by a range of \textit{frequencies}.
\added{Here, we define the heating frequency in terms of the time between consecutive heating events such that impulsive heating corresponds to low-frequency heating.}

Two often-used diagnostics of the frequency of energy deposition in the coronal plasma are the cool emission measure slope and the time lag, the temporal offset which maximizes the cross-correlation between pairs of imaging channels.
The emission measure distribution, $\mathrm{EM}(T)=\int\mathrm{d}h\,n_e^2$, where $n_e$ is the electron density and the integration is taken along the line of sight, is well-described by the power-law relationship $\textup{EM}(T)\sim T^a$, for $a>0$, over the temperature range $10^{5.5}\lesssim T\lesssim10^{6.5}$ K \citep{jordan_structure_1975,jordan_structure_1976}.
$a$, the emission measure slope in $\log-\log$ space, parameterizes the width of the emission measure distribution and is a commonly used diagnostic for the heating frequency \citep[e.g.][]{tripathi_emission_2011,winebarger_using_2011,warren_constraints_2011,mulu-moore_can_2011,bradshaw_diagnosing_2012,schmelz_cold_2012,reep_diagnosing_2013,del_zanna_evolution_2015}.

The time lag analysis of \citet{viall_evidence_2012} provides an additional diagnostic of the heating frequency. \citet{viall_patterns_2011} showed that, as the plasma cools, the intensity will peak in successively cooler passbands of the Atmospheric Imaging Assembly \citep[AIA,][]{lemen_atmospheric_2012} on the Solar Dynamics Observatory \citep[SDO,][]{pesnell_solar_2012} spacecraft.
The temporal offset which maximizes the cross-correlation between these intensities is a proxy for the cooling time of the plasma between these channels.
\deleted{Provided the ``hot'' channel precedes the ``cool'' channel, cooling plasma produces a positive time lag.}
\added{The general convention is that the ``hot'' channel precedes the ``cool'' channel.
In this case, cooling plasma produces a positive time lag, and negative time lags indicates heating.
However, the multiple temperature peaks in the AIA response functions creates a nuance to this general rule.
The 94 and 131 \AA{} channels are doubly peaked in the range of temperatures over which an impulsive heating event may span (see \autoref{fig:aia-response}).
Not knowing a priori what physics occurs where, we follow the convention set by \citet{viall_evidence_2012}, where 94 \AA{} is always assumed to be a hot channel, and $8$ MK plasma dominates the emission, and 131 \AA{} is always assumed to be a cool channel where $0.5$ MK plasma dominates the emission.
When this is not the dominate emission, and the assumption is violated, opposite time lag conventions result.
We remove this ambiguity with the other four AIA channels, since they span the temperatures in between.} 

Any viable heating model must account for the range of observed emission measure slopes and time lags \citep[\citetalias{viall_survey_2017} hereafter]{viall_survey_2017}.
However, accurately predicting the distributions of these observables for a given heating model is challenging as several factors are likely to impact these diagnostics, including multiple emitting structures along the LOS and non-equilibrium ionization \citep[e.g.][]{barnes_inference_2016}.

In \citet[\citetalias{barnes_understanding_2019} hereafter]{barnes_understanding_2019}, we forward modeled emission from \AR{} NOAA 1158 as observed by the six EUV channels of AIA.
Using a potential field extrapolation combined with $5\times10^3$ separate instances of the Enthalpy-based Thermal Evolution of Loops model \citep[EBTEL,][]{klimchuk_highly_2008,cargill_enthalpy-based_2012,cargill_enthalpy-based_2012-1,barnes_inference_2016}, we predicted time-dependent intensities in each pixel of the \AR{} for a range of nanoflare heating frequencies.
We defined the heating frequency in terms of the dimensionless ratio 
\begin{equation}\label{eq:heating_types}
    \varepsilon = \frac{\langle\twait\rangle}{\tau_{\textup{cool}}}
    \begin{cases} 
        < 1, &  \text{high frequency},\\
        \sim1, & \text{intermediate frequency}, \\
        > 1, & \text{low frequency},
     \end{cases}
\end{equation}
where $\tau_{\textup{cool}}$ is the fundamental cooling timescale due to thermal conduction and radiation \citep[see appendix of][]{cargill_active_2014} and $\langle \twait\rangle$ is the average waiting time between consecutive heating events on a given strand.
As in \citetalias{barnes_understanding_2019}, we define a \textit{strand} to be a flux tube with the largest possible isothermal cross-section and the fundamental unit of the corona while a \textit{loop} is \replaced{an intensity enhancement relative to the background diffuse emission and an observationally-defined feature}{an observationally-defined feature and an intensity enhancement relative to the surrounding diffuse emission.}.
\added{Additionally, we note that for each simulated strand, even within a single heating frequency category, there is a spread in the distribution of heating frequencies due to the dependence of the waiting time on the energy of the event.
This parameterization of the heating is discussed in detail in Section 2.3 of \citetalias{barnes_understanding_2019}.}

From our predicted intensities, we computed the emission measure slope as well as the time lag and the maximum cross-correlation for all 15 AIA channel pairs.
We found that signatures of the heating frequency persist in both the emission measure slope and the time lag and that, in particular, negative time lags \replaced{where the ``cool'' channel is 131 \AA{}, provide a possible diagnostic for $\ge10$ MK plasma}{that occur in pairs with the 131 \AA{} channel provide a possible diagnostic for $\ge10$ MK plasma, provided they are co-spatial with positive time lags in the other channel pairs}.

While such predicted diagnostics are useful in understanding how observables respond to the frequency of energy deposition, systematically assessing real observations in terms of said model results is nontrivial.
Attempts to tune model parameters to exactly match a single observation (e.g. a light curve from a single pixel) are not likely to generalize well to other data (``overfitting'').
Additionally, purely qualitative comparisons between real data and forward models provide no constraint on the observation with respect to the model inputs, regardless of how sophisticated the simulation may be.
\explain{This is meant as a rebuttal to the many talks/papers that put their model and observed images side-by-side and declare them to be ``realistic'' without doing any sort of quantitative analysis to determine how different their model and the observations actually are. Maybe this should be reworded if that is not clear?}

Because of the ability to learn non-linear relationships from arbitrary data, machine learning  is an excellent tool for systematically \replaced{comparing}{and quantitatively assessing differences between} observations and simulations for a range of input parameters.
Machine learning has a variety of applications in solar physics, from predicting coronal mass ejections \citep[e.g.][]{bobra_predicting_2016} to deconvolving magnetograms \citep{baso_enhancing_2018}.
In particular, \citet{tajfirouze_time-resolved_2016} trained a neural network \explain{I think neural network is a common enough term that this does not have to be defined?} on $>10^5$ modeled 94 \AA{} and 335 \AA{} AIA light curves simulated using EBTEL for a large parameter space of heating properties.
\replaced{They found that a sample of observed light curves were most consistent with many frequent events drawn from a power-law distribution with index $\alpha=-1.5$ though the overall agreement between the best fit and the observation was poor.}{Using this trained network, they classified a sample of $\sim4000$ s light curves, extracted from \AR s thought to contain ``very hot'' ($\ge6$ MK) plasma, in terms of the model heating input parameters.
They found that these observations were most consistent with many frequent short-duration events drawn from a power-law distribution with index $\alpha=-1.5$}
\added{However, comparisons between the time evolution of the 94 and 335 \AA{} intensities for the observations and most-consistent models, as determined by the trained network, were poor, possibly due to spatial averaging or limitations in the heating parameter space.}
Combined with predicted observables from sophisticated forward models, systematic comparisons using machine learning methods are well-poised to place strong constraints on heating properties in \AR s.

In this paper, the second in a series concerned with constraining nanoflare heating properties, we train a machine learning classification model, specifically a random forest classifier, to identify the most probable heating frequency in each pixel of \AR{} NOAA 1158 using the predicted emission measure slopes, time lags, and maximum cross-correlations from \citetalias{barnes_understanding_2019}.
In \autoref{sec:observations}, we describe how the full 12 hours of multi-wavelength AIA observations were processed and how we computed the emission measure slope (\autoref{sec:em_slopes}) and time lag (\autoref{sec:timelags}).
\autoref{sec:compare} describes the random forest classification model as well as the data preparation procedure (\autoref{sec:data-prep}) and \autoref{sec:feature-combos} and \ref{sec:feature-importance} show the predicted heating frequency in each pixel for several different combinations of features.
In \autoref{sec:discussion} we discuss the results of our classification model and provide some concluding comments in \autoref{sec:conclusions}.
To our knowledge, this paper represents the first attempt to use multiple diagnostics and machine learning to map the heating properties across an observed \AR{}.